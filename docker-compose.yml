version: '3'
services:
  atlas-r:
    build:
      context: './redis/'
    image: atlas-r
    container_name: atlas-r
    #command: redis-server /usr/redis/redis-cluster.conf --requirepass changeme
    expose:
      - "6379"
    networks:
        atlas:
          aliases:
            - atlas-r
    restart: on-failure
    env_file: .env-atlas-r

  atlas-s:
    build:
      context: './atlas/'
    image: atlas-s
    depends_on:
            - atlas-r
    container_name: atlas-s
    networks:
      atlas:
        aliases:
          - atlas-s
    ports:
      - "27018-27019:27018-27019/udp"
      - "27020-27021:27020-27021"
    env_file: .env-atlas-s

networks:
  atlas:
    driver: bridge
